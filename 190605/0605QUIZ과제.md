6조

```SQL
SELECT RANK() OVER(ORDER BY 12*(SAL+NVL(COMM,0)) DESC) AS RANKING, ENAME AS EN, 12*(SAL+NVL(COMM,0)) AS ASAL FROM EMP
WHERE 12*(SAL+NVL(COMM,0)) >= (
   SELECT AVG(12*(SAL+NVL(COMM,0))) FROM EMP
)

--

SELECT RANK() OVER(ORDER BY s.ASAL DESC) AS RANKING, e.ENM AS EN, s.ASAL AS ASAL 
FROM T_EMP e, T_SAL s 
WHERE s.ASAL > (
   SELECT AVG(s2.ASAL) FROM T_SAL s2, T_EMP e2
   WHERE e2.ENO = s2.ENO
)
AND e.ENO = s.ENO
```

```SQL
SELECT * FROM EMP e
WHERE e.JOB IN ('MANAGER')
AND SAL >= (SELECT MAX(AVG(SAL)) FROM EMP e2 GROUP BY DEPTNO)
```

3조

```SQL
SELECT E1.EMPNO, E1.ENAME, E1.JOB, E1.MGR, E2.EMPNO, E2.ENAME, E2.JOB, E2.MGR
FROM EMP e1 INNER JOIN EMP e2
ON e1.MGR IN e2.EMPNO
ORDER BY E2.JOB DESC
```

```SQL
SELECT e.ENO, e.ENM, s.ASAL , d.DNM, d.DLOC , 
RANK() OVER (ORDER BY s.ASAL DESC) AS RANKING 
FROM T_EMP e, T_SAL s, T_DEPT d
WHERE e.DNO = d.DNO
AND e.ENO = s.ENO
AND s.ASAL >= (
   SELECT AVG(s1.ASAL) FROM T_SAL s1, T_EMP e1
   WHERE s1.ENO = e1.ENO 
   AND e1.DNO = e.DNO
   GROUP BY e1.DNO
)
ORDER BY s.ASAL DESC
```

1조

```SQL
SELECT e.ENO, e.ENM, e.SAL, s.ASAL, 
RANK() OVER(ORDER BY s.ASAL DESC) AS RANKING, d.DNM
FROM T_EMP e, T_SAL s, T_DEPT d
WHERE e.ENO=s.ENO AND e.DNO=d.DNO
AND s.ASAL >= (
   SELECT AVG(s2.ASAL) FROM T_SAL s2
)
```

```SQL
SELECT ENO, ENM, ASAL, DNM, DLOC, RANK, TOTAL
FROM (
   SELECT e.ENO, e.ENM, s.ASAL, d.DNM, d.DLOC,
   RANK() OVER(ORDER BY s.ASAL DESC) AS RANK,
   (SELECT COUNT(*) FROM EMP) AS TOTAL
   FROM T_EMP e, T_SAL s, T_DEPT d
   WHERE e.ENO=s.ENO AND e.DNO=d.DNO
   AND e.SAL >= (
      SELECT AVG(e2.SAL) FROM T_EMP e2
      WHERE e2.DNO = e.DNO
      GROUP BY e2.DNO
   )
   AND d.DLOC NOT IN ('DALLAS')
)
WHERE RANK<=2
```

2조 

```SQL
SELECT ENAME, SAL,
TO_CHAR(HIREDATE,'YYYY') AS EMPYEARS,
TRUNC((SYSDATE-HIREDATE)/365) AS YEARS, 
RANK() OVER (ORDER BY TO_CHAR(HIREDATE,'YYYY')) AS RANKING 
FROM EMP e1
WHERE SAL >= (
  SELECT MAX(SAL) FROM EMP e2
  WHERE TO_CHAR(e1.HIREDATE,'YYYY') = TO_CHAR(e2.HIREDATE,'YYYY')
  GROUP BY TO_CHAR(e1.HIREDATE,'YYYY')
)
```

```SQL
CREATE VIEW T_DAL(ENAME, ASAL, DNO, LOC)
AS (
   SELECT e.ENAME, (e.SAL+NVL(e.COMM,0))*12, e.DEPTNO, d.LOC
   FROM EMP e, DEPT d
   WHERE d.DEPTNO=e.DEPTNO AND LOC='DALLAS'
)
CREATE VIEW T_CHI(ENAME, ASAL, DNO, LOC)
AS (
   SELECT e.ENAME, (e.SAL+NVL(e.COMM,0))*12, e.DEPTNO, d.LOC
   FROM EMP e, DEPT d
   WHERE d.DEPTNO=e.DEPTNO AND LOC='CHICAGO'
)
--
SELECT ENAME, ASAL, DNO, LOC, 
RANK() OVER(ORDER BY ASAL DESC) AS RANKING
FROM T_DAL
UNION
SELECT ENAME, ASAL, DNO, LOC, 
RANK() OVER(ORDER BY ASAL DESC) AS RANKING
FROM T_CHI
ORDER BY LOC, RANKING
```

4조

```SQL
SELECT ROW_NUMBER() OVER(ORDER BY SAL DESC) AS ROW_NUM, e.ENO, e.ENM, e.SAL, d.DNM
FROM T_EMP e, T_DEPT d
WHERE d.DNO = e.DNO
AND d.DNM = 'RESEARCH'
```

```SQL
SELECT SUM(s.ASAL)AS ASALSUM, d.DLOC AS LOC 
FROM T_EMP e INNER JOIN T_DEPT d ON(e.DNO=d.DNO)
INNER JOIN T_SAL s ON(e.ENO=s.ENO)
WHERE s.ASAL >= (
   SELECT AVG(s2.ASAL) FROM T_EMP e2, T_SAL s2
   WHERE s2.ENO=e2.ENO AND e.DNO=e2.DNO
)
GROUP BY ROLLUP(d.DLOC)
```

5조

```SQL

```

```SQL

```

